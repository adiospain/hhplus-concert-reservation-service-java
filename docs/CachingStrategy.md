# 캐싱 전략 및 구현 보고서

콘서트 예약 시스템에서 발생하는 다양한 Query에 대한 분석과 캐싱 전략 설계를 다룹니다.
특히, Redis를 활용하여 시스템 성능을 최적화하고, 대량의 트래픽 발생 시 지연을 최소화하는 방법을 제시합니다.

## Query 분석 및 캐싱 전략 설계
1. 콘서트 조회
    - **Query**: `SELECT * FROM concert` [findAll()]
    - 분석 : 정보 변경이 적으며, 조회 빈도가 높음.
    - 캐싱전략 :
        - 캐시 키 : `allConcerts`
        - TTL : 10분
        - 캐시 로직 :
            - 캐시에서 `allConcerts` 키로 조회
            - 캐시 미스 시 DB에서 조회하고, 결과를 캐시에 저장
            - 스탬피드 현상 방지를 위해 redis 분산락 적용
2. 콘서트 예약가능 날짜 조회
    - **Query**: SELECT cs FROM concert_schedule WHERE concert_id = ? [findAllByConcertId()]
    - 분석: 예약 가능 날짜도 변경이 적으며, 조회 빈도가 높음.
    - 캐싱 전략:
        - 캐시 키: `concert:{concert_id}:concertSchedules`
        - TTL: 10분
        - 캐시 로직:
            - 캐시에서 `concert:{concert_id}:concertSchedules` 키로 조회
            - 캐시 미스 시 DB에서 조회하고, 결과를 캐시에 저장
            - 스탬피드 현상 방지를 위해 redis 분산락 적용
3. 콘서트 좌석 조회
    - 분석: 실시간으로 좌석 선점이 발생하여 잦은 변경이 생김.
    - 캐싱 전략: 캐싱하지 않음.
4. 포인트 / 예약 / 결제
    - 분석: 사용자별 정보로, 실시간 업데이트가 중요하며, 개인정보가 포함될 수 있음.
    - 캐싱 전략: 캐싱하지 않음.
## 테스트 시나리오
1. 전체 콘서트 목록 조회
    - 검증항목
        - 반환된 콘서트 목록의 정확성
        - 첫 실행 시간과 이후 실행 시간의 평균 비교
2. 예약 가능한 콘서트 날짜 조회
    - 검증항목
        - 반환된 콘서트 상세 정보의 정확성
        - 첫 실행 시간과 이후 실행 시간의 평균 비교
## 테스트 결과
1. 전체 콘서트 목록 조회 테스트 결과
    - 첫 실행 시간 : 83.048701 ms
    - 이후 실행 시간 평균 0.156085 ms
    - 성능 향상률 : 99.8121% | [(첫 실행시간 - 평균 실행시간) / 첫 실행시간 * 100]%
2. 예약 가능한 콘서트 날짜 조회 테스트 결과
    - 첫 실행 시간 : 79.825361 ms
    - 이후 실행 시간 평균 0.198505 ms
    - 성능 향상률 : 99.7514% | [(첫 실행시간 - 평균 실행시간) / 첫 실행시간 * 100]%

## 향후 계획
    - 부하 테스트를 통한 시스템 한계 파악
    - 캐시 만료 정책 최적화
    - 실제 사용자 패턴을 반영한 시나리오 기반 테스트 수행

## 결론
캐싱 매커니즘 도입으로 서비스 응답시간이 크게 개선 되었습니다.
향후 추가적인 테스트와 최적화를 통해 서비스의 성능을 더욱 개선할 수 있을 것으로 기대됩니다.